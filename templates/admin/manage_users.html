{% extends "admin/admin_layout.html" %}
{% block title %}Manage Users{% endblock %}
{% block header_title %}User Management{% endblock %}

{% block admin_content %}
<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold text-white">Manage Users</h1>
    <a href="{{ url_for('admin_add_user') }}" class="bg-teal-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-teal-700 flex items-center space-x-2 text-sm">
        <i class="fa fa-user-plus"></i>
        <span>Add New User</span>
    </a>
</div>

<div class="bg-gray-800 shadow-xl rounded-lg overflow-x-auto border border-gray-700">
    <table class="min-w-full divide-y divide-gray-700">
        <thead class="bg-gray-700/50">
            <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Name</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Contact</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase">Role</th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-400 uppercase">Actions</th>
            </tr>
        </thead>
        <tbody class="bg-gray-800 divide-y divide-gray-700">
            {% for user in users %}
            <tr>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-white">{{ user.full_name }}</div>
                    <div class="text-sm text-gray-500">{{ user.email }}</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">{{ user.contact_info or 'N/A' }}</td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                    {% if user.status == 'active' %} bg-green-500/20 text-green-300
                    {% else %} bg-red-500/20 text-red-300 {% endif %}">
                        {{ user.status|capitalize }}
                    </span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-400">{{ user.role_name|capitalize if user.role_name else 'User' }}</td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-4">
                    <a href="{{ url_for('admin_edit_user', user_id=user.id) }}" class="text-teal-400 hover:text-teal-300">Edit</a>
                    {% if user.status == 'active' %}
                    <form action="{{ url_for('admin_update_user_status', user_id=user.id) }}" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to suspend this user?');">
                        <input type="hidden" name="action" value="suspend">
                        <button type="submit" class="text-yellow-400 hover:text-yellow-300">Suspend</button>
                    </form>
                    {% else %}
                    <form action="{{ url_for('admin_update_user_status', user_id=user.id) }}" method="POST" class="inline" onsubmit="return confirm('Are you sure you want to activate this user?');">
                        <input type="hidden" name="action" value="activate">
                        <button type="submit" class="text-green-400 hover:text-green-300">Activate</button>
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
